<!DOCTYPE html><html><head>
<script src="js/lib.js"></script>
<title>Opera flag options</title>
<style>

</style>
</head><body>
    <b>Host</b>: <span id="host"></span><br>
    <b>IP</b>: <span id="ipAddress"></span><br>
    <b>Country</b>: <span id="countryName"></span><br>
    <b>Region</b>: <span id="regionName"></span><br>
    <b>City</b>: <span id="cityName"></span><br>
    <b>Zip code</b>: <span id="zipCode"></span><br>
    <b>Latitude</b>: <span id="latitude"></span><br>
    <b>Longitude</b>: <span id="longitude"></span><br>
    <b>Timezone</b>: <span id="timeZone"></span><br>
<hr>
    <a id="whois" href="">who.is</a>
    <a id="ipinfo" href="">ipinfodb</a>
    <a id="gmaps" href="">Google maps</a>

<script>
var ids=['host','ipAddress','countryName','regionName','cityName','zipCode','latitude','longitude','timeZone'];
var reps=[['whois','http://who.is/[host]'],['ipinfo','http://ipinfodb.com/ip_locator.php?ip=[host]'],['gmaps','http://maps.google.com/?ie=UTF8&ll=[latitude],[longitude]']]
opera.extension.addEventListener( "message", function(arg)
    {
    //~ opera.postError('received: '+JSON.stringify(arg.data));
    var q,w,s;
    for(q in ids)
	gebi(ids[q]).innerHTML=arg.data[ids[q]];
    for(w in reps)
	{
	s=reps[w][1];
	for(q in ids)
	    s=s.replace('['+ids[q]+']',arg.data[ids[q]]);
	gebi(reps[w][0]).href=s;
	}
    }, false);

opera.extension.postMessage( "popup" );
</script>
</body></html>
